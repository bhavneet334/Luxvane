<!DOCTYPE html>
<html>
  <head>
    <title>Products â€“ Luxvane Admin</title>
    <link rel="stylesheet" href="/stylesheets/layout.css">
    <link rel="stylesheet" href="/stylesheets/products.css">
    <link rel="stylesheet" href="/stylesheets/header.css">
    <link rel="stylesheet" href="/stylesheets/modal.css">
  </head>
  <body>

    <div class="admin-shell">

      <aside class="admin-sidebar">
        <div class="sidebar-header">
          <a href="/owners/products/create" class="sidebar-create-btn">
            + Create Product
          </a>
        </div>
        
        <nav class="sidebar-nav">
          <!-- Main Navigation -->
          <div class="nav-section">
            <a href="/owners/dashboard" class="nav-item">
              <span class="nav-icon">ðŸ“Š</span>
              <span class="nav-label">Dashboard</span>
            </a>
            
            <a href="/owners/products" class="nav-item">
              <span class="nav-icon">ðŸ“¦</span>
              <span class="nav-label">All Products</span>
            </a>
          </div>
          
          <!-- Category Filters -->
          <div class="nav-section">
            <div class="nav-section-header">
              <span class="nav-section-title">Categories</span>
            </div>
            <div class="nav-section-content">
              <% if (categories && categories.length > 0) { %>
                <% categories.forEach(function(category) { %>
                  <a href="/owners/products?category=<%= category._id %>" 
                     class="nav-item nav-item-sub <%= selectedCategory === category._id.toString() ? 'active' : '' %>">
                    <span class="nav-label"><%= category.name %></span>
                  </a>
                <% }); %>
              <% } else { %>
                <div class="nav-empty">No categories</div>
              <% } %>
            </div>
          </div>
        </nav>
      </aside>

      <!-- <aside class="products-sidebar">
        <a href="/owners/products/create" class="btn btn-primary">
          + Create product
        </a>

        <a href="/owners/products" class="<%= !selectedCategory ? 'active' : '' %>"> All products </a>
        
        <h4>Filter by Categories</h4>
        <% categories.forEach(function(category) { %>
          <h4 class="<%= selectedCategory === category._id.toString() ? 'active' : '' %>">
            <a href="/owners/products?category=<%= category._id %>">
              <%= category.name %>
            </a>
          </h4>
        <% }); %>
      </aside> -->

      <!-- MAIN AREA -->
      <div class="admin-main">

        <!-- HEADER -->
        <%- include('../partials/header.ejs') %>

        <!-- FLASH MESSAGES -->
        <% if (success && success.length > 0) { %>
          <div class="flash flash-success"><%= success %></div>
        <% } %>

        <% if (error && error.length > 0) { %>
          <div class="flash flash-error"><%= error %></div>
        <% } %>

        <!-- PAGE CONTENT -->
        <main class="page-container product-page">
          
          <div class="products-grid">
            <% products.forEach(p => { %>
              <div class="product-card">
                
                 <img src="<%= p.image.replace('/upload/', '/upload/w_400,h_400,c_fill,q_auto/') %>" 
                    class="product-img" 
                    loading="lazy"
                    decoding="async"
                    alt="<%= p.name %>" />

                <h2 class="product-name"><%= p.name %></h2>

                <p class="product-price"><%= p.price %>$</p>

                <p class="product-desc"><%= p.description %></p>

                <% if (p.discount && p.discount > 0) { %>
                  <p class="product-discount">
                    Discount: <%= p.discount %>%
                  </p>
                <% } %>

                <div class="product-actions">
                  <a
                    href="/owners/products/<%= p._id %>/edit"
                    class="btn btn-outline"
                  >
                    Edit
                  </a>

                  <form
                    action="/owners/products/<%= p._id %>/delete"
                    method="POST"
                    class="delete-form"
                    data-item-name="<%= p.name %>"
                    data-entity-type="Product"
                  >
                    <button type="button" class="btn btn-danger delete-btn">
                      Delete
                    </button>
                  </form>

                </div>
              </div>
            <% }) %>
          </div>

        </main>
      </div>
    </div>

    <%- include('../partials/delete-modal.ejs') %>

    <script src="/javascripts/delete-modal.js"></script>

  </body>
</html>
